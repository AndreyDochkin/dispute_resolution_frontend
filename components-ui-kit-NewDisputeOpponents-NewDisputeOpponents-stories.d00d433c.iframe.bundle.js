"use strict";(self.webpackChunkdispute_resolution=self.webpackChunkdispute_resolution||[]).push([[68],{"./src/components/ui-kit/NewDisputeOpponents/NewDisputeOpponents.stories.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:function(){return Default},__namedExportsOrder:function(){return __namedExportsOrder}});var _Default$parameters,_Default$parameters2,_Default$parameters2$,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_NewDisputeOpponents__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/ui-kit/NewDisputeOpponents/NewDisputeOpponents.jsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./src/index.css"),__webpack_require__("./node_modules/react/jsx-runtime.js"));__webpack_exports__.default={title:"Dispute_Resolution/Inputs/Multi choice",component:_NewDisputeOpponents__WEBPACK_IMPORTED_MODULE_0__.h};var Default=function Default(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_NewDisputeOpponents__WEBPACK_IMPORTED_MODULE_0__.h,{})};Default.parameters=(0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)((0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},Default.parameters),{},{docs:(0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)((0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({},null===(_Default$parameters=Default.parameters)||void 0===_Default$parameters?void 0:_Default$parameters.docs),{},{source:(0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_3__.Z)({originalSource:"() => <NewDisputeOpponents />"},null===(_Default$parameters2=Default.parameters)||void 0===_Default$parameters2||null===(_Default$parameters2$=_Default$parameters2.docs)||void 0===_Default$parameters2$?void 0:_Default$parameters2$.source)})});var __namedExportsOrder=["Default"];Default.__docgenInfo={description:"",methods:[],displayName:"Default"}},"./src/components/ui-kit/NewDisputeOpponents/NewDisputeOpponents.jsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{h:function(){return NewDisputeOpponents_NewDisputeOpponents}});var toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),useOutsideClick=__webpack_require__("./src/hook/useOutsideClick.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),NewDisputeOpponentsModal_NewDisputeOpponentsModal=function NewDisputeOpponentsModal(_ref){var searchOpponent=_ref.searchOpponent,chooseOpponentModal=_ref.chooseOpponentModal,handleAddOpponent=_ref.handleAddOpponent,handleCloseOpponentsModal=_ref.handleCloseOpponentsModal,opponentModalRef=(0,useOutsideClick.Z)(chooseOpponentModal,handleCloseOpponentsModal);return(0,react.useEffect)((function(){if(chooseOpponentModal){var handleESC=function handleESC(evt){"Escape"===evt.key&&handleCloseOpponentsModal()};return document.addEventListener("keydown",handleESC),function(){document.removeEventListener("keydown",handleESC)}}}),[chooseOpponentModal,handleCloseOpponentsModal]),(0,jsx_runtime.jsx)("div",{ref:opponentModalRef,className:"new-dispute-opponents__input-modal \n      ".concat(chooseOpponentModal&&"new-dispute-opponents__input-modal_opened"),children:searchOpponent.length>0?searchOpponent.map((function(item){return(0,jsx_runtime.jsx)("button",{className:"new-dispute-opponents__modal-item",onClick:function onClick(){return handleAddOpponent(item)},alt:"Добавить оппонента",children:"".concat(item.first_name," ").concat(item.last_name)},item.id)})):(0,jsx_runtime.jsx)("button",{className:"new-dispute-opponents__modal-item new-dispute-opponents__modal-item_not-found",alt:"Оппоненты не найдены",children:"Оппоненты не найдены"})})};NewDisputeOpponentsModal_NewDisputeOpponentsModal.__docgenInfo={description:"",methods:[],displayName:"NewDisputeOpponentsModal",props:{searchOpponent:{description:"",type:{name:"arrayOf",value:{name:"shape",value:{email:{name:"string",required:!1},id:{name:"number",required:!1},first_name:{name:"string",required:!1},last_name:{name:"string",required:!1},phone_number:{name:"string",required:!1},role:{name:"string",required:!1}}}},required:!0},chooseOpponentModal:{description:"",type:{name:"bool"},required:!0},handleAddOpponent:{description:"",type:{name:"func"},required:!0},handleCloseOpponentsModal:{description:"",type:{name:"func"},required:!0}}};var user_api=__webpack_require__("./src/utils/api/user.api.js"),NewDisputeOpponents_NewDisputeOpponents=function NewDisputeOpponents(_ref){var selectedOpponents=_ref.selectedOpponents,handleSetSelectedOpponents=_ref.handleSetSelectedOpponents,_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),chooseOpponentModal=_useState2[0],setChooseOpponentModal=_useState2[1],_useState3=(0,react.useState)([]),_useState4=(0,slicedToArray.Z)(_useState3,2),searchOpponent=_useState4[0],setSearchOpponent=_useState4[1],_useState5=(0,react.useState)({}),_useState6=(0,slicedToArray.Z)(_useState5,2),opponentsInput=_useState6[0],setOpponentsInput=_useState6[1],sortObjOpponents=function sortObjOpponents(dataObj){return dataObj.sort((function(a,b){return a.last_name.localeCompare(b.last_name)||a.first_name.localeCompare(b.first_name)})),dataObj},handleChangeOpponentsInput=function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(evt){var _evt$target,name,value,findUserApi,findUser;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_evt$target=evt.target,name=_evt$target.name,value=_evt$target.value,setOpponentsInput((function(prev){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},prev),{},(0,defineProperty.Z)({},name,value))})),value&&!((null==value?void 0:value.length)<3)){_context.next=5;break}return setChooseOpponentModal(!1),_context.abrupt("return");case 5:return setChooseOpponentModal(!0),_context.next=8,(0,user_api.Rf)({queryParam:"search",value:value});case 8:findUserApi=_context.sent,findUser=findUserApi.reduce((function(acc,cur){return selectedOpponents.find((function(item){return item.id===cur.id}))||acc.push(cur),acc}),[]),setSearchOpponent(sortObjOpponents(findUser));case 11:case"end":return _context.stop()}}),_callee)})));return function handleChangeOpponentsInput(_x){return _ref2.apply(this,arguments)}}(),handleCloseOpponentsModal=function handleCloseOpponentsModal(){setOpponentsInput(""),setChooseOpponentModal(!1),document.getElementById("new-dispute-opponents__input").focus()};return(0,jsx_runtime.jsxs)("div",{className:"new-dipute-opponents__choice ".concat(chooseOpponentModal&&"new-dipute-opponents__choice_opened"),children:[selectedOpponents&&selectedOpponents.length>0?selectedOpponents.map((function(item){return(0,jsx_runtime.jsxs)("div",{className:"new-dispute-opponents__selected-item",children:[(0,jsx_runtime.jsx)("div",{className:"new-dispute-opponents__selected-name",children:"".concat(item.first_name," ").concat(item.last_name)}),(0,jsx_runtime.jsx)("button",{className:"new-dispute-opponents__selected-button",type:"button",alt:"Удалить оппонента",onClick:function onClick(){return function handleDeleteOpponent(user){var updatedList=selectedOpponents.filter((function(item){return item.id!==user.id}));handleSetSelectedOpponents(updatedList)}(item)}})]},"".concat(item.first_name," ").concat(item.last_name))})):null,(0,jsx_runtime.jsx)("div",{className:"new-dispute-opponents__input-frame",children:(0,jsx_runtime.jsx)("div",{className:"new-dispute-opponents__input-section",children:(0,jsx_runtime.jsx)("input",{id:"new-dispute-opponents__input",className:"new-dispute-opponents__input",name:"opponents",value:opponentsInput.opponents||"",type:"text",onChange:handleChangeOpponentsInput})})}),(0,jsx_runtime.jsx)("div",{className:"new-dipute-opponents__choice-glue-modal",children:(0,jsx_runtime.jsx)(NewDisputeOpponentsModal_NewDisputeOpponentsModal,{searchOpponent:searchOpponent,chooseOpponentModal:chooseOpponentModal,handleAddOpponent:function handleAddOpponent(user){handleSetSelectedOpponents([].concat((0,toConsumableArray.Z)(selectedOpponents),[user])),handleCloseOpponentsModal()},handleCloseOpponentsModal:handleCloseOpponentsModal})})]})};NewDisputeOpponents_NewDisputeOpponents.defaultProps={selectedOpponents:[]},NewDisputeOpponents_NewDisputeOpponents.__docgenInfo={description:"",methods:[],displayName:"NewDisputeOpponents",props:{selectedOpponents:{defaultValue:{value:"[]",computed:!1},description:"",type:{name:"arrayOf",value:{name:"shape",value:{email:{name:"string",required:!1},id:{name:"number",required:!1},first_name:{name:"string",required:!1},last_name:{name:"string",required:!1},phone_number:{name:"string",required:!1},role:{name:"string",required:!1}}}},required:!1},handleSetSelectedOpponents:{description:"",type:{name:"func"},required:!0}}}},"./src/hook/useOutsideClick.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");__webpack_exports__.Z=function useOutsideClick(isMenuOpen,closeMenu){var ref=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){if(!isMenuOpen)return function(){};var handleClick=function handleClick(event){ref.current&&!ref.current.contains(event.target)&&(closeMenu(),event.stopPropagation())};return document.addEventListener("click",handleClick,!0),function(){document.removeEventListener("click",handleClick,!0)}})),ref}},"./src/utils/api/requestPattern.api.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$:function(){return makeRequest}});var D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),responceProcessing=function responceProcessing(res){return res.ok?204===res.status?Promise.resolve(res.status):res.json():res.json().then((function(data){return Promise.reject({res:res,data:data})}))},makeRequest=function(){var _ref=(0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__.Z)((0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_1__.Z)().mark((function _callee(url,method,body,param){var headers,fetchURL,token,queryParam,value,config,res;return(0,D_practicum_dispute_resolution_frontend_node_modules_babel_runtime_helpers_esm_regeneratorRuntime_js__WEBPACK_IMPORTED_MODULE_1__.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return headers={"Content-Type":"application/json"},fetchURL="https://ccdia.acceleratorpracticum.ru"+url,null!=(token=localStorage.getItem("token"))&&(headers.authorization="Token ".concat(token)),void 0!==param&&(queryParam=param.queryParam,value=param.value,"search"===queryParam?fetchURL+="?search=".concat(value):"pagination"===queryParam&&(fetchURL+="?page=".concat(value.page,"&page_size=").concat(value.size))),config={method:method,headers:headers},void 0!==body&&(config.body=JSON.stringify(body)),_context.next=9,fetch(fetchURL,config);case 9:return res=_context.sent,_context.abrupt("return",responceProcessing(res));case 11:case"end":return _context.stop()}}),_callee)})));return function makeRequest(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}()},"./src/utils/api/user.api.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Cp:function(){return changePassword},Rf:function(){return getUsers},bG:function(){return getUserInfo},kS:function(){return logout},x4:function(){return login}});var _requestPattern_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/api/requestPattern.api.js"),getUsers=function getUsers(param){return(0,_requestPattern_api__WEBPACK_IMPORTED_MODULE_0__.$)("/api/users/","GET",void 0,param)},getUserInfo=function getUserInfo(){return(0,_requestPattern_api__WEBPACK_IMPORTED_MODULE_0__.$)("/api/users/me/","GET",void 0,void 0)},login=function login(_ref2){var email=_ref2.email,password=_ref2.password;return(0,_requestPattern_api__WEBPACK_IMPORTED_MODULE_0__.$)("/api/auth/token/login/","POST",{email:email,password:password},void 0)},logout=function logout(){return(0,_requestPattern_api__WEBPACK_IMPORTED_MODULE_0__.$)("/api/auth/token/logout/","POST",void 0,void 0)},changePassword=function changePassword(_ref3){var new_password=_ref3.new_password,current_password=_ref3.current_password;return(0,_requestPattern_api__WEBPACK_IMPORTED_MODULE_0__.$)("/api/users/set_password/","POST",{new_password:new_password,current_password:current_password},void 0)}}}]);